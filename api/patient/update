.php
<?php
// Required headers
header("Access-Control-Allow-Origin: *");
header("Content-Type: application/json; charset=UTF-8");
header("Access-Control-Allow-Methods: POST");
header("Access-Control-Max-Age: 3600");
header("Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With");

// Include database and object files
include_once '../config/database.php';
include_once '../objects/patient.php';
include_once '../middleware/auth_middleware.php';

// Start session if not already started
if (session_status() === PHP_SESSION_NONE) {
    session_start();
}

// Get database connection
$database = new Database();
$db = $database->getConnection();

// Initialize patient object
$patient = new Patient($db);

// Get authenticated user
$user = Auth::isAuthenticated();

if (!$user || $user->role !== 'admin') {
    // Only admin can update patients
    http_response_code(403);
    echo json_encode(array("message" => "You don't have permission to update patients"));
    exit;
}

// Set patient property values
$patient->id = isset($_POST["id"]) ? $_POST["id"] : die();
$patient->name = $_POST["name"];
$patient->phone = $_POST["phone"];
$patient->gender = $_POST["gender"];
$patient->health_condition = $_POST["health_condition"];
$patient->doctor_id = $_POST["doctor_id"];
$patient->nurse_id = $_POST["nurse_id"];

// Update the patient
if($patient->update()){
    // Set response code - 200 ok
    http_response_code(200);
    
    // Tell the user
    echo json_encode(array(
        "status" => true,
        "message" => "Patient was updated."
    ));
}
else{
    // Set response code - 503 service unavailable
    http_response_code(503);
    
    // Tell the user
    echo json_encode(array(
        "status" => false,
        "message" => "Unable to update patient."
    ));
}